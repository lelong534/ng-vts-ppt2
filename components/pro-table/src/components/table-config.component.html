<div class='vts-protable-configuration'>
  <div class="btn-area">
    <div vts-col class="btn-control-area">
      <button vts-button vtsType="primary" [vtsSize]="'xs'" (click)="openDrawer()"><i class="collapse-icon" vts-icon
          [vtsType]="'AddCircle'"></i>New</button>
      <button vts-button class="btn-table-config" vtsType="primary" [vtsSize]="'xs'" (click)="exportDataToFile()"><i
          class="collapse-icon" vts-icon [vtsType]="'AddCircle'"></i>Export</button>
      <button vts-button class="btn-table-config" vtsType="primary" [vtsSize]="'xs'" (click)="showUploadModal()"><i
          class="collapse-icon" vts-icon [vtsType]="'AddCircle'"></i>Import</button>
      <ng-container>
        <button vts-button class="btn-table-config" vtsType="default" [vtsSize]="'xs'"
          [disabled]="checkedItemsAmount<=0" (click)="showDeleteModal()">Delete all selected items</button>
      </ng-container>
    </div>
    <div vts-col class="btn-config-area">
      <a vts-button class="btn-table-config" vts-dropdown vtsTrigger="click" [vtsDropdownMenu]="menuSwapVert">
        <i vts-icon vtsType="SwapVert"></i>
      </a>
      <vts-dropdown-menu #menuSwapVert="vtsDropdownMenu">
        <ul vts-menu>
          <li vts-menu-item (click)="handleChangeRowHeight('normal')">Normal</li>
          <li vts-menu-item (click)="handleChangeRowHeight('expand')">Expand</li>
          <li vts-menu-item (click)="handleChangeRowHeight('narrow')">Narrow</li>
        </ul>
      </vts-dropdown-menu>
      <button vts-button class="btn-table-config" vtsType="default" (click)="reloadTableData()"><i vts-icon
          vtsType="Sync"></i></button>
      <a vts-button vts-dropdown vtsTrigger="click" [vtsDropdownMenu]="menuSettings" class="btn-table-config">
        <i vts-icon vtsType="Settings"></i>
      </a>
      <vts-dropdown-menu #menuSettings="vtsDropdownMenu">
        <ul vts-menu>
          <li vts-menu-item>Display all column</li>
          <vts-divider></vts-divider>
          <ng-container *ngFor="let property of properties" cdkDropList (cdkDropListDropped)="drop($event)">
            <li vts-menu-item *ngIf="property.checked" cdkDrag>{{property.headerTitle}}</li>
          </ng-container>
          <vts-divider></vts-divider>
          <button class="btn-properties-config" vts-button [vtsSize]="'xs'" vtsType="primary">Save</button>
          <button class="btn-properties-config" vts-button [vtsSize]="'xs'" vtsType="default">Reset</button>
        </ul>
      </vts-dropdown-menu>
    </div>
  </div>

  <ng-container *ngIf="checkedItemsAmount > 0">
    <ng-template [ngTemplateOutlet]="selectedInfo"></ng-template>
  </ng-container>
  <ng-template #selectedInfo>
    <div class="select-label">
      <span style="padding-left: 16px;">
        <span style="color: #CB002B">{{ checkedItemsAmount }}</span> items is selected <span style="color: #CB002B">| <a
            (click)="showDeleteModal()">Clear selected</a></span>
      </span>
    </div>
  </ng-template>

  <table style="width: -webkit-fill-available; margin-top: 16px;">
    <thead>
      <tr [ngStyle]="{'height':vtsRowHeight+'px'}">
        <th [vtsChecked]="checked" [vtsIndeterminate]="indeterminate" (vtsCheckedChange)="onAllChecked($event)"></th>
        <th [vtsSortDirections]="sortDirections" [vtsSortFn]="sortFn" *ngFor="let property of properties">
          {{property.headerTitle}}</th>
        <th style="padding: 16px 16px;">Action</th>
      </tr>
    </thead>
    <tbody class="vts-table-tbody">
      <tr *ngFor="let data of displayedData; index as i" [ngStyle]="{'height':vtsRowHeight+'px'}">
        <td [vtsChecked]="setOfCheckedId.has(data.id)" (vtsCheckedChange)="onItemChecked(data.id, $event)"></td>
        <td *ngFor="let prop of properties" vtsAlign="left">{{ data[prop.propertyName] }}</td>
        <td>
          <a>View</a>
          <a> | </a>
          <a vts-dropdown vtsTrigger="click" [vtsDropdownMenu]="menuActions">More<i class="collapse-icon" vts-icon
              [vtsType]="vtsIsCollapse ? 'ArrowMiniDown' : 'ArrowMiniUp'"></i></a>
          <vts-dropdown-menu #menuActions="vtsDropdownMenu">
            <ul vts-menu>
              <li vts-menu-item (click)="onEditDataItem(data.id)">Edit</li>
              <li vts-menu-item (click)="showDeleteItemModal(data.id)">Delete</li>
              <li vts-menu-item>Enable/Disable</li>
            </ul>
          </vts-dropdown-menu>
        </td>
      </tr>
    </tbody>
  </table>

  <ng-container *ngIf="vtsPaginationPosition === 'both' || vtsPaginationPosition === 'bottom'">
    <ng-template [ngTemplateOutlet]="paginationTemplate"></ng-template>
  </ng-container>
  <ng-template #paginationTemplate>
    <vts-pagination [vtsPageIndex]="vtsPageIndex" [vtsTotal]="vtsTotal" [vtsPageSize]="vtsPageSize"
      [vtsShowTotal]="rangeTemplate" class="protable-paging" (vtsPageIndexChange)="onChangePageIndex($event)">
    </vts-pagination>
    <ng-template #totalTemplate let-total>Total {{ total }} items</ng-template>
    <ng-template #rangeTemplate let-range="range" let-total>
      {{ range[0] }}-{{ range[1] }} / {{ total }} items
    </ng-template>
  </ng-template>
</div>

<vts-modal [(vtsVisible)]="isVisibleModal" [vtsTitle]="modalData.title" [vtsContent]="modalData.content"
  (vtsOnCancel)="handleCancelModal()" (vtsOnOk)="handleOkModal()" [vtsOkLoading]="isOkLoadingModal">
  <p *vtsModalContent>Modal Content</p>
</vts-modal>

<vts-modal [(vtsVisible)]="isVisibleDelete" [vtsTitle]="modalDeleteData.title" [vtsContent]="modalDeleteData.content"
  (vtsOnCancel)="handleCancelDelete()" [vtsOkLoading]="isOkLoadingDelete">
  <p *vtsModalContent>Modal Content</p>
</vts-modal>

<vts-modal [(vtsVisible)]="isVisibleUpload" [vtsWidth]="720" [vtsOkText]="uploadData.okText"
  (vtsOnCancel)="handleCancelUpload()" (vtsOnOk)="handleOkUpload()">
  <ng-container *vtsModalContent>
    <vts-upload vtsType="drag" vtsAccept=".png, .jpg, .jpeg, .svg" [vtsMultiple]="true"
      [vtsOpenFileDialogOnClick]="false" [vtsAction]="uploadData.url" (vtsChange)="handleChangeUpload($event)"
      #container>
      <p class="vts-upload-drag-icon">
        <i vts-icon vtsType="UploadCloud"></i>
      </p>
      <p class="text-hint">
        Kéo thả ảnh/video hoặc
        <a vts-button vtsType="link" (click)="container.openDialog()">Chọn file</a>
        để tải lên
      </p>
      <p class="text-hint">
        Chỉ cho phép file dạng .png, .jpg, .jpeg, .svg và dung lượng không quá 100Mb
      </p>
    </vts-upload>
  </ng-container>
</vts-modal>

<table-drawer [saveRequest]="saveRequest" [headers]="properties" (close)="closeDrawer()" [visibleDrawer]="visibleDrawer" [data]="drawerData"></table-drawer>